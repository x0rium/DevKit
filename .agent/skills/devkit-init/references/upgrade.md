# Upgrade Mode

spec-kit exists (.specify/ present). No .devkit/ yet.
Developer is already using spec-kit and wants to add the full DevKit layer.

## What This Means

spec-kit is already running. There are specs, possibly a constitution.md.
We need to reverse-engineer DevKit artifacts from what spec-kit has,
then connect them so ArchKit owns constitution.md going forward.

## Phase 1: Read Existing spec-kit Artifacts

Read all files in `.specify/`:
- `constitution.md` — project principles and constraints
- `spec.md` — feature specifications
- `plan.md` — technical plans
- `tasks/` — implementation tasks

Understand what's already been built and decided.

## Phase 2: Extract ArchKit Artifacts from constitution.md

constitution.md contains decisions that belong in ArchKit.

Extract:
- Tech stack decisions → ADR entries
- Constraints and rules → invariant candidates
- Patterns and standards → more invariants

Create `.devkit/arch/invariants.md` from these.
Create `.devkit/arch/decisions/` ADR files.

Mark all as `inferred` with `SOURCE: constitution.md`.

## Phase 3: Extract ProductKit Artifacts

Look in constitution.md and spec.md for:
- Who the user is
- UX rules and constraints
- What's in scope / out of scope

Create `.devkit/product/users.md` and `ux_invariants.md`.
Mark as `inferred`.

## Phase 4: Link DevKit to spec-kit

Going forward, constitution.md is OWNED by ArchKit.
Add a note at the top of `.specify/constitution.md`:

```markdown
<!-- GENERATED BY DEVKIT — do not edit manually -->
<!-- Source: .devkit/arch/invariants.md + decisions/ -->
<!-- Regenerate with: /arch-kit generate-constitution -->
```

## Phase 5: Produce Status File

Create `.devkit/STATUS.md`:

```markdown
# DevKit Status

MODE: upgrade-from-speckit
INITIALIZED: [date]
CURRENT_PHASE: arch-review

## Migration Summary
SPEC_KIT_SPECS_FOUND: N
INVARIANTS_EXTRACTED: M
CONSTITUTION: linked (DevKit now owns it)

## Required Actions
- [ ] Review .devkit/arch/invariants.md
- [ ] Confirm or correct extracted decisions
- [ ] Run /arch-kit to fill gaps

## Phase Status
- [~] ResearchKit (not available — existing project)
- [~] ProductKit (partially extracted)
- [ ] ArchKit (review required)
- [x] SpecKit (already in use)
- [ ] QAKit
```

## Message to Developer

```
DevKit initialized over your existing spec-kit project.

Extracted from your spec-kit artifacts:
  Invariants: N (from constitution.md — review required)
  Decisions:  M (inferred — review required)

constitution.md is now managed by ArchKit.
Changes to architecture go through /arch-kit, 
which regenerates constitution.md automatically.

Next steps:
1. Review .devkit/arch/invariants.md
2. Run /arch-kit to verify and complete the picture
3. Continue using spec-kit as normal — it now has a verified foundation
```
